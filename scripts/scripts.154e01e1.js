"use strict";function d3Map(a){function b(a){return a&&a.properties?a.properties.NOMBRE_DPT:null}function c(a){var c=b(a);return c?c.length:0}function d(a){return"#915299"}function e(a){var b,c,e;if(a&&h!==a){var f=o.centroid(a);b=f[0],c=f[1],e=4,h=a}else b=i/2,c=j/2,e=1,h=null;r.selectAll("path").style("fill",function(a){return h&&a===h?"#D5708B":d(a)}),q.transition().duration(750).attr("transform","translate("+i/2+","+j/2+")scale("+e+")translate("+-b+","+-c+")")}function f(a){d3.select(this).style("fill","orange");var c=b(a);k.transition().duration(200).style("opacity",.9),k.html(l(c)).style("left",d3.event.pageX+"px").style("top",d3.event.pageY-28+"px")}function g(a){r.selectAll("path").style("fill",function(a){return h&&a===h?"#D5708B":d(a)}),k.transition().duration(500).style("opacity",0)}var h,i=445,j=500,k=d3.select("body").append("div").attr("id","tooltip"),l=function(a){return"<span>"+a+"</span>"},m=d3.scale.linear().domain([1,20]).clamp(!0).range(["#fff","#409A99"]),n=d3.geo.mercator().scale(1500).center([-74,4.5]).translate([i/2,j/2]),o=d3.geo.path().projection(n),p=d3.select(a).attr("width",i).attr("height",j);p.append("rect").attr("class","background").attr("width",i).attr("height",j).on("click",e);var q=p.append("g"),r=(q.append("g").classed("effect-layer",!0),q.append("g").classed("map-layer",!0));d3.json("colombia.geo.json",function(a,b){var h=b.features;m.domain([0,d3.max(h,c)]),r.selectAll("path").data(h).enter().append("path").attr("d",o).attr("vector-effect","non-scaling-stroke").style("fill",d).on("mouseover",f).on("mouseout",g).on("click",e)})}angular.module("comoVamosColombiaApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","highcharts-ng","ngLodash"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl",controllerAs:"about"}).otherwise({redirectTo:"/"})}]),angular.module("comoVamosColombiaApp").controller("MainCtrl",["$timeout","Api","Graph",function(a,b,c){var d=this;d.firstSelectedOption={city:void 0,category:void 0,indicator:void 0},d.secondSelectedOption={city:void 0,category:void 0,indicator:void 0},d.initialize=function(){d.showChart=!1,d.data=b.dummy_cities(),d.drawGraph()},d.drawGraph=function(){d.showChart=!0,a(function(){d.chartConfig=c.chartConfig([b.dummy_indicator_1(),b.dummy_indicator_2()])},1e3)},d.initialize()}]),angular.module("comoVamosColombiaApp").controller("AboutCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("comoVamosColombiaApp").directive("d3Map",function(){return{template:"<svg></svg>",restrict:"E",link:function(a,b,c){d3Map(b[0].firstChild)}}}),angular.module("comoVamosColombiaApp").service("Api",["$http",function(a){function b(a){return"/"+a}var c="http://104.154.49.35:5000/",d={cities:c+"cities",indicator:function(a,d){return c+"indicator"+b(a)+b(d)}},e=function(){return a.get(d.cities)},f=function(b,c){return a.get(d.indicator(b,c))},g=function(){return{name:"Tasa de Desempleo 1",city:"Bogotá",type:"objetivo",timeline:[{year:1989,value:.137679449},{year:1990,value:.13449362},{year:1991,value:.12050198},{year:1992,value:.135813811},{year:1993,value:.156584082},{year:1994,value:.138943827},{year:1995,value:.122501056},{year:1996,value:.124101423},{year:1997,value:.112241421},{year:1998,value:.102}]}},h=function(){return{name:"Variable categórica",city:"Ibengue",type:"subjetivo ordinal",timeline:[{year:1989,value:[{name:"Sí",value:.1},{name:"No",value:.2}]},{year:1990,value:[{name:"Sí",value:.1},{name:"No",value:.2}]},{year:1991,value:[{name:"Sí",value:.1},{name:"No",value:.2}]},{year:1992,value:[{name:"Sí",value:.1},{name:"No",value:.2}]},{year:1993,value:[{name:"Sí",value:.1},{name:"No",value:.2}]},{year:1994,value:[{name:"Sí",value:.1},{name:"No",value:.2}]},{year:1995,value:[{name:"Sí",value:.6175},{name:"No",value:.3825}]},{year:1996,value:[{name:"Sí",value:.39},{name:"No",value:.61}]},{year:1997,value:[{name:"Sí",value:.45},{name:"No",value:.55}]},{year:1998,value:[{name:"Sí",value:0},{name:"No",value:0}]}]}},i=function(){return[{name:"Bogotá",categories:[{name:"Optimismo y bienestar subjetivo 1",indicators:[{name:"Tasa de Desempleo 1",type:"objetivo",description:"Tasa de desempleo 1 "},{name:"CV6A 1",type:"subjetivo categorico 1",description:"Independientemente si usted nació o no en [CIUDAD], se siente de [CIUDAD] o de otra parte del país?"},{name:"CO3 1",type:"subjetivo ordinal 1",description:"¿En general cómo califica la calidad de la información que recibe?"}]},{name:"Calidad De Vida",indicators:[{name:"Tasa de Desempleo 1",type:"objetivo",description:"Tasa de desempleo"},{name:"CV6A 1",type:"subjetivo categorico",description:"Independientemente si usted nació o no en [CIUDAD], se siente de [CIUDAD] o de otra parte del país?"},{name:"CO3 1",type:"subjetivo ordinal",description:"¿En general cómo califica la calidad de la información que recibe?"}]}]},{name:"Ibagué",categories:[{name:"Optimismo y bienestar subjetivo 2",indicators:[{name:"Tasa de Desempleo 2",type:"objetivo",description:"Tasa de desempleo"},{name:"CV6A 2",type:"subjetivo categorico",description:"Independientemente si usted nació o no en [CIUDAD], se siente de [CIUDAD] o de otra parte del país?"},{name:"CO3 2",type:"subjetivo ordinal",description:"¿En general cómo califica la calidad de la información que recibe?"}]},{name:"Calidad De Vida 2",indicators:[{name:"Tasa de Desempleo 2",type:"objetivo",description:"Tasa de desempleo"},{name:"CV6A 2",type:"subjetivo categorico",description:"Independientemente si usted nació o no en [CIUDAD], se siente de [CIUDAD] o de otra parte del país?"},{name:"CO3 2",type:"subjetivo ordinal",description:"¿En general cómo califica la calidad de la información que recibe?"}]}]}]};return{cities:e,indicator:f,dummy_cities:i,dummy_indicator_1:g,dummy_indicator_2:h}}]),angular.module("comoVamosColombiaApp").service("Graph",["Defaults","lodash",function(a,b){var c=function(a){return a.length>1?(console.log(a[0].name+" vs "+a[1].name),a[0].name+" vs "+a[1].name):(console.log(a[0].name),a[0].name)},d=function(a,c,d){var e={name:a,type:"spline",stack:"1"};return e.data=b.map(d,function(a){return[a.year.toString(),a.value]}),e},e=function(a,c,d){if(0!==d.length){var e=d[0].value,f=b.pluck(e,"name"),g=b.map(f,function(a){var c={name:a,type:"column",yAxis:1};return c.data=b.map(d,function(c){var d=b.result(b.findWhere(c.value,{name:a}),"value");return[c.year.toString(),d]}),c});return g}},f=function(a){return b.flatten(b.map(a,function(a){switch(a.type){case"objetivo":return d(a.name,a.city,a.timeline);case"subjetivo ordinal":return e(a.name,a.city,a.timeline);case"subjetivo categorico":return e(a.name,a.city,a.timeline)}}))},g=function(a){return{options:{chart:{zoomType:"xy"},plotOptions:{column:{stacking:"normal"}},xAxis:{type:"category",labels:{rotation:-45,style:{fontSize:"13px",fontFamily:"Verdana, sans-serif"}}},yAxis:[{labels:{formatter:function(){return this.value},style:{color:"#000"}},title:{text:"",style:{color:"#000"}}},{labels:{formatter:function(){return this.value},style:{color:"#000"}},opposite:!0}]},series:f(a),title:{text:c(a)}}};return{chartConfig:g}}]),angular.module("comoVamosColombiaApp").service("Defaults",function(){var a={firstAccent:"#BB0E80",secondAccent:"#2C031E",thirdAccent:"#F46DC6",fourthAccent:"#646464"},b={firstAccent:"#BB0E80",secondAccent:"#2C031E",thirdAccent:"#F46DC6",fourthAccent:"#646464"};return{graphColors:a,mapColors:b}}),angular.module("comoVamosColombiaApp").run(["$templateCache",function(a){a.put("views/about.html","<p>This is the about view.</p>"),a.put("views/main.html",'<section class="text-center"> <h1>Visualización ¿Cómo Vamos Colombia?</h1> </section> <section> <p> Pequeña descripción de qué es, qué hace, cómo funciona. Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. </p> </section> <section> <p class="main-label"> Elige una ciudad: </p> <div class="col-xs-12 col-sm-4"> <select class="form-control" name="" ng-model="main.firstSelectedOption.city" ng-options="option.name for option in main.data"> <!-- <option>Bogotá</option> --> </select> </div> <div class="col-xs-12 col-sm-4"> <select class="form-control" name="" ng-model="main.firstSelectedOption.category" ng-options="option.name for option in main.firstSelectedOption.city.categories"> <!-- <option>Optimismo y bienestar</option> --> </select> </div> <div class="col-xs-12 col-sm-4"> <select class="form-control" name="" ng-model="main.firstSelectedOption.indicator" ng-options="option.name for option in main.firstSelectedOption.category.indicators" ng-change="main.drawGraph()"> <!-- <option>CV5 - Pensando en las ...</option> --> </select> </div> </section> <section> <p class="main-label"> Compara con otra ciudad: </p> <div class="col-xs-12 col-sm-4"> <select class="form-control" name="" ng-model="main.secondSelectedOption.city" ng-options="option.name for option in main.data"> <!-- <option>Bogotá</option> --> </select> </div> <div class="col-xs-12 col-sm-4"> <select class="form-control" name="" ng-model="main.secondSelectedOption.category" ng-options="option.name for option in main.secondSelectedOption.city.categories"> <!-- <option>Optimismo y bienestar</option> --> </select> </div> <div class="col-xs-12 col-sm-4"> <select class="form-control" name="" ng-model="main.secondSelectedOption.indicator" ng-options="option.name for option in main.secondSelectedOption.category.indicators" ng-change="main.drawGraph()"> <!-- <option>CV5 - Pensando en las ...</option> --> </select> </div> </section> <section class="text-center"> <!-- <h1>Nombre del indicador</h1> --> <highchart id="chart1" config="main.chartConfig" ng-show="main.showChart"></highchart> </section> <section> <div class="row"> <div class="col-xs-12 col-sm-6"> <h3>Variable 1</h3> <d3-map></d3-map> </div> <div class="col-xs-12 col-sm-6"> <h3>Variable 2</h3> <d3-map></d3-map> </div> </div> </section> <section> <div class="row"> <div class="col-xs-12 col-sm-6"> <div class="poll_experience"> <p> <strong>Some variable description.</strong> Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. </p> </div> </div> <div class="col-xs-12 col-sm-6"> <div class="poll_experience"> <p> <strong>Some poll description.</strong> Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. </p> <ul> <li><span class="index">1.</span>Muy Mala</li> <li><span class="index">2.</span>Mala</li> <li><span class="index">3.</span>Regular</li> <li><span class="index">4.</span>Buena</li> <li><span class="index">5.</span>Muy buena</li> </ul> </div> </div> </div> </section>')}]);